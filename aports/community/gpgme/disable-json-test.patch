The t-json test fails due to an unpatched upstream bug. Due to the
importance of this package, we do not want to disable the entire test
suite. Instead we only disable the t-json test but patching the
autogenerated Makefile.in.

Remove this patch as soon as the bug has been resolved upstream.

See: https://dev.gnupg.org/T4820

diff -upr gpgme-1.13.1.orig/tests/json/Makefile.in gpgme-1.13.1/tests/json/Makefile.in
--- gpgme-1.13.1.orig/tests/json/Makefile.in	2020-05-02 12:28:44.526707197 +0200
+++ gpgme-1.13.1/tests/json/Makefile.in	2020-05-02 12:29:07.393394561 +0200
@@ -129,11 +129,7 @@ mkinstalldirs = $(SHELL) $(top_srcdir)/b
 CONFIG_HEADER = $(top_builddir)/conf/config.h
 CONFIG_CLEAN_FILES =
 CONFIG_CLEAN_VPATH_FILES =
-am__EXEEXT_1 = t-json$(EXEEXT)
 PROGRAMS = $(noinst_PROGRAMS)
-am_t_json_OBJECTS = t-json.$(OBJEXT)
-t_json_OBJECTS = $(am_t_json_OBJECTS)
-t_json_DEPENDENCIES = ../../src/cJSON.o ../../src/libgpgme.la
 AM_V_lt = $(am__v_lt_@AM_V@)
 am__v_lt_ = $(am__v_lt_@AM_DEFAULT_V@)
 am__v_lt_0 = --silent
@@ -172,8 +168,6 @@ AM_V_CCLD = $(am__v_CCLD_@AM_V@)
 am__v_CCLD_ = $(am__v_CCLD_@AM_DEFAULT_V@)
 am__v_CCLD_0 = @echo "  CCLD    " $@;
 am__v_CCLD_1 = 
-SOURCES = $(t_json_SOURCES)
-DIST_SOURCES = $(t_json_SOURCES)
 am__can_run_installinfo = \
   case $$AM_UPDATE_INFO_DIR in \
     n|no|NO) false;; \
@@ -427,7 +421,6 @@ GNUPGHOME = $(abs_builddir)
 TESTS_ENVIRONMENT = GNUPGHOME=$(GNUPGHOME) LC_ALL=C GPG_AGENT_INFO= \
                     top_srcdir=$(top_srcdir) gpgme_json=$(GPGME_JSON)
 
-c_tests = t-json
 CLEANFILES = secring.gpg pubring.gpg pubring.kbx trustdb.gpg dirmngr.conf \
 	gpg-agent.conf pubring.kbx~ S.gpg-agent gpg.conf pubring.gpg~ \
 	random_seed S.gpg-agent .gpg-v21-migrated pubring-stamp \
@@ -463,11 +456,8 @@ EXTRA_DIST = initial.test final.test \
 BUILT_SOURCES = gpg.conf gpg-agent.conf pubring-stamp \
            gpg-sample.stamp
 
-t_json_SOURCES = t-json.c
 AM_LDFLAGS = -no-install
 LDADD = ../../src/libgpgme.la @LDADD_FOR_TESTS_KLUDGE@
-t_json_LDADD = ../../src/cJSON.o -lm ../../src/libgpgme.la @GPG_ERROR_LIBS@ \
-	       @LDADD_FOR_TESTS_KLUDGE@
 
 AM_CPPFLAGS = -I$(top_builddir)/src @GPG_ERROR_CFLAGS@
 all: $(BUILT_SOURCES)
@@ -514,18 +504,12 @@ clean-noinstPROGRAMS:
 	echo " rm -f" $$list; \
 	rm -f $$list
 
-t-json$(EXEEXT): $(t_json_OBJECTS) $(t_json_DEPENDENCIES) $(EXTRA_t_json_DEPENDENCIES) 
-	@rm -f t-json$(EXEEXT)
-	$(AM_V_CCLD)$(LINK) $(t_json_OBJECTS) $(t_json_LDADD) $(LIBS)
-
 mostlyclean-compile:
 	-rm -f *.$(OBJEXT)
 
 distclean-compile:
 	-rm -f *.tab.c
 
-@AMDEP_TRUE@@am__include@ @am__quote@./$(DEPDIR)/t-json.Po@am__quote@
-
 .c.o:
 @am__fastdepCC_TRUE@	$(AM_V_CC)$(COMPILE) -MT $@ -MD -MP -MF $(DEPDIR)/$*.Tpo -c -o $@ $<
 @am__fastdepCC_TRUE@	$(AM_V_at)$(am__mv) $(DEPDIR)/$*.Tpo $(DEPDIR)/$*.Po
